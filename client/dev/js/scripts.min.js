/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	//Concatenates all main index files from each directory.
	
	function addIndex (directory) {
	 return __webpack_require__(27)("./" + directory + '/index.js');
	};
	
	__webpack_require__(26);
	
	addIndex('music');
	addIndex('navigation');
	addIndex('animations');


/***/ },
/* 1 */,
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(3);


/***/ },
/* 3 */
/***/ function(module, exports) {

	$(document).ready(function () {  
	  $('.artist-box').dimmer({
	    on: 'hover'
	  })
	  $(window).resize(function () {
	    if ($(window).width() < 870) {
	      $('#player-menu').hide();
	    }
	    else if ($(window).width() > 870) {
	      $('#player-menu').show();       
	    }
	  })
	})
	
	
	


/***/ },
/* 4 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(5);


/***/ },
/* 5 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .controller('musicPlayer', musicPlayer)
	    
	  musicPlayer.$inject = ['$scope','$http', 'spotifySearch', 'playerControls', 'scSearch', 'tabs', 'playlists', 'searchType', 'voice'];
	
	  function musicPlayer ($scope, $http, spotifySearch, playerControls, scSearch, tabs, playlists, searchType, voice) {
	      vm = this;
	      vm.topArtists;
	      vm.tracks = [];
	      vm.playlistTabs = playlists.currentPlaylists;
	      vm.playerImage = 'assets/images/music-player/default-album.png';
	      vm.playerTitle = 'Title';
	      vm.playerArtist = 'Artist';
	      vm.playerInfo = 'album';
	      vm.playStateButton = 'play icon';
	      vm.searchDisplay = searchType.searchState; 
	      vm.addPlaylistState = playlists.state.addField;
	      vm.addPlaylistButton = playlists.state.addButton; 
	      vm.annyang = voice.initialize();  
	      
	      SC.initialize({client_id: 'b10a9e77003de676a40bcd4ce7346f03'})  
	      
	      $scope.spotifyQuery;
	      $scope.scQuery; 
	      $scope.newPlaylist; 
	
	      vm.digest = function () {
	        _.defer(function() {
	          $scope.$digest();
	        })
	      }
	      vm.togglePlay = function () {
	        playerControls.togglePlay();
	      } 
	      vm.playNext = function () {
	        playerControls.nextSong();
	      }
	      vm.playPrevious = function () {
	        playerControls.previousSong();
	      }
	      vm.voicePlay = function () {
	        playerControls.voicePlay();
	      }
	      vm.voicePause = function () {
	        playerControls.voicePause();
	      } 
	      vm.voiceStart = function () {
	        playerControls.voiceStart();
	      }     
	      vm.changeSearch = function (event) {
	        var attribute = event.target.getAttribute('data-search');
	        searchType.changeSearch(attribute)
	      }
	      vm.switchTabs = function (event, playlist) {
	        var attribute = event.target.getAttribute('data-tab');
	        var isPlaylist = event.target.getAttribute('data-playlist');
	        if (isPlaylist) {
	          playlists.displayTracks(playlist);     
	        }
	        tabs.switchTabs(attribute);
	      }    
	      vm.revealNewPlaylist = function () {
	        playlists.revealAddField();
	        vm.addPlaylistState = playlists.state.addField;
	        vm.addPlaylistButton = playlists.state.addButton;
	      }
	      vm.createNewPlaylist = function (event) {
	        if(event.keyCode === 13) {
	          if ($scope.newPlaylist === "" || $scope.newPlaylist === undefined) {
	            alert('please enter playlist name')
	            return;
	          }
	          playlists.createNewPlaylist($scope.newPlaylist);
	          $scope.newPlaylist= "";
	          vm.addPlaylistState = playlists.state.addField;
	          vm.addPlaylistButton = playlists.state.addButton;
	          vm.digest();
	        }
	      }
	      vm.openDropDown = function () {
	        $('.ui.dropdown').dropdown('restore defaults'); 
	        vm.digest();
	      } 
	      vm.addTrack = function (trackKey, playlist) {
	        playlists.addTrack(trackKey, playlist);
	        vm.digest();
	      } 
	      vm.removeTrack = function (trackId) {
	        playlists.removeTrack(trackId);
	      }          
	      vm.voiceSearch = function (query) {
	        var attribute = 'search';
	          tabs.switchTabs(attribute);
	          scSearch.allTracks(query);
	          $scope.scQuery = "";
	      }
	      vm.scSearchEnter = function () {            
	        if (event.keyCode === 13) {
	          var attribute = event.target.getAttribute('data-tab');
	          tabs.switchTabs(attribute);
	          scSearch.allTracks($scope.scQuery);
	          $scope.scQuery = "";
	          if ($(window).width() < 870) {
	            $('#player-menu').hide();
	          }
	        };
	      }   
	      vm.spotifySearchEnter = function () {
	        if (event.keyCode === 13) {
	          var attribute = event.target.getAttribute('data-tab');
	          tabs.switchTabs(attribute);
	          spotifySearch.makeRequest($scope.spotifyQuery);
	          $scope.spotifyQuery = "";
	          if ($(window).width() < 870) {
	            $('#player-menu').hide();
	          }
	        }
	      }
	
	      $scope.playMusic = function (event) { 
	        var song = event.target.getAttribute('data-song');     
	        playerControls.playMusic(song);
	      }    
	  }


/***/ },
/* 6 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(7);


/***/ },
/* 7 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .directive('songList', function () {
	    return {
	      scope: true,
	      restrict: 'A',
	      replace: false,
	      templateUrl: 'templates/track-list.html',
	      link: function (scope, elem, attrs) {
	        elem.bind('click', function (event) {   
	          $('.ui.dropdown').dropdown('restore defaults');            
	        })
	      }
	    }
	  })

/***/ },
/* 8 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(4);
	__webpack_require__(6);
	__webpack_require__(9);


/***/ },
/* 9 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(10);
	__webpack_require__(11);
	__webpack_require__(12);
	__webpack_require__(13);
	__webpack_require__(14);
	__webpack_require__(15);
	__webpack_require__(16);
	__webpack_require__(16);
	__webpack_require__(17);
	__webpack_require__(18);


/***/ },
/* 10 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('playerControls', [function () { 
	    
	    var masterPlayer = new Audio();
	
	    masterPlayer.playState = {
	      playing: false,
	      currentSong: null
	    }
	
	    function getSong (song) {
	      scClient = 'b10a9e77003de676a40bcd4ce7346f03'
	      if (song.company === 'soundcloud') {
	        return 'https://api.soundcloud.com/tracks/' + song.urlSource + '/stream?client_id=' + scClient;
	      }
	      else if (song.company === 'spotify') {
	        return song.urlSource;
	      }
	    };
	
	    function setCurrent (currentSong) {
	      var songKey = currentSong.key;
	      masterPlayer.playState.currentSong = songKey;
	    }
	
	    function setPlayerInfo(currentSong) {
	      vm.playerImage = currentSong.image;
	      vm.playerTitle = currentSong.name;
	      vm.playerArtist = currentSong.artist;
	      vm.playerInfo = currentSong.album; 
	    }
	    
	    masterPlayer.nextSong = function () {
	      var current = masterPlayer.playState.currentSong;
	      var next = current + 1;
	
	      if (masterPlayer.playState.playing === true && vm.tracks[next]) {
	        masterPlayer.src = getSong(vm.tracks[next]);
	        setPlayerInfo(vm.tracks[next]);
	        setCurrent(vm.tracks[next]);
	        masterPlayer.play();
	      }
	      else if (!(vm.tracks[next])) {
	        masterPlayer.src = getSong(vm.tracks[0]);
	        setPlayerInfo(vm.tracks[0]);
	        setCurrent(vm.tracks[0]);
	        masterPlayer.play();
	      }
	    }
	
	    masterPlayer.previousSong = function () {
	      var current = masterPlayer.playState.currentSong;
	      var previous = current - 1;
	      
	      if (masterPlayer.playState.playing === true && vm.tracks[previous]) {
	        masterPlayer.src = getSong(vm.tracks[previous]);
	        setPlayerInfo(vm.tracks[previous]);
	        setCurrent(vm.tracks[previous]);
	        masterPlayer.play();
	      }
	      else if (!(vm.tracks[previous])) {
	        var lastTrack = vm.tracks[((0 - vm.tracks.length)*-1) - 1];
	        masterPlayer.src = getSong(lastTrack);
	        setPlayerInfo(lastTrack);
	        setCurrent(lastTrack);
	        masterPlayer.play();
	      }
	    }
	
	    masterPlayer.toggleState = function () {
	      if (masterPlayer.playState.playing === false) {
	        masterPlayer.playState.playing = true;
	        vm.playStateButton = 'pause icon';
	      }
	      else if (masterPlayer.playState.playing === true) {
	        masterPlayer.playState.playing = false;
	        vm.playStateButton = 'play icon';
	        
	      }
	    }
	    masterPlayer.voicePlay = function () {
	      if (masterPlayer.playState.playing === false) {
	        masterPlayer.play();
	        masterPlayer.toggleState();
	        vm.digest();
	      }      
	    }
	
	    masterPlayer.voicePause = function () {
	      if (masterPlayer.playState.playing === true) {
	        masterPlayer.pause();
	        masterPlayer.toggleState();
	        vm.digest();
	      }      
	    }
	
	    masterPlayer.voiceStart = function () {
	      if (vm.tracks.length > 1 && masterPlayer.playState.playing === false) {
	        masterPlayer.src = getSong(vm.tracks[0]);
	        setPlayerInfo(vm.tracks[0]); 
	        setCurrent(vm.tracks[0]);
	        masterPlayer.play();
	        masterPlayer.toggleState();
	        vm.digest();
	      }
	    }
	
	    masterPlayer.togglePlay = function () {
	      if (vm.tracks.length > 1 && masterPlayer.src === '') {
	        masterPlayer.src = getSong(vm.tracks[0]);
	        setPlayerInfo(vm.tracks[0]); 
	        setCurrent(vm.tracks[0]);
	      }
	      else if (masterPlayer.src === '') {
	        return
	      };      
	      (masterPlayer.playState.playing === false) ? masterPlayer.play() : masterPlayer.pause();
	      masterPlayer.toggleState();
	      vm.digest();
	    }
	
	    masterPlayer.playMusic = function (song) {
	      _.each(vm.tracks, function (eachSong) {
	        if (eachSong.name === song) {
	          setCurrent(eachSong);   
	          setPlayerInfo(eachSong);
	          masterPlayer.src = getSong(eachSong);
	          (masterPlayer.playState.playing === false) ? masterPlayer.togglePlay() : masterPlayer.play();
	          vm.digest();
	        }
	      })
	    }
	
	  return masterPlayer
	    
	  }])

/***/ },
/* 11 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('playlistConstructor', [function () {
	
	    return playlist
	
	    function playlist (name) {
	      this.name = name;
	      this.tracks = [];
	    }
	    
	  }])

/***/ },
/* 12 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('playlists', ['playlistConstructor', function (playlistConstructor) {
	    
	
	    var samplePlaylist = new playlistConstructor('My Playlist');
	
	    var playlist = {
	      addTrack: addTrack,
	      createNewPlaylist: createNewPlaylist,
	      displayTracks: displayTracks,
	      removeTrack: removeTrack,
	      revealAddField: revealAddField,    
	      state: {
	        addField: false,
	        addButton: true
	      }
	    };
	
	    playlist.currentPlaylists = [samplePlaylist];
	
	    return playlist;
	
	    function revealAddField () {
	        playlist.state.addField = true;
	        playlist.state.addButton = false;
	      }
	
	    function addTrack (trackKey, playlist) {
	      var currentPlaylist;
	
	      _.map(vm.playlistTabs, function findPlaylist (eachPlaylist) {
	        if (eachPlaylist.name === playlist) {
	          currentPlaylist = eachPlaylist;        
	        }
	      })
	
	      _.map(vm.tracks, function findTrack (eachTrack) {
	        if (eachTrack.key === trackKey) {          
	          currentPlaylist.tracks.push(eachTrack);
	          var removedDuplicates = _.uniq(currentPlaylist.tracks);
	          currentPlaylist.tracks = removedDuplicates;        
	        }
	      })
	    }
	
	    function removeTrack (trackId) {
	      vm.tracks.forEach(function (track, i) {
	        if (track.key === trackId) {
	          vm.tracks.splice(i, 1);
	        }
	      }) 
	    }
	
	    function displayTracks (playlist) {
	      vm.tracks = [];
	
	      _.map(vm.playlistTabs, function (eachPlaylist, i) {
	        if (eachPlaylist.name === playlist) {
	          vm.tracks = eachPlaylist.tracks;
	        }
	      })
	
	      _.map(vm.tracks, function (eachTrack, i) {
	        eachTrack.deleteAble.changeState();
	        eachTrack.key = i;
	      })
	    }
	
	    function createNewPlaylist (name) {
	      var newPlaylist = new playlistConstructor (name);
	      
	      playlist.currentPlaylists.push(newPlaylist);
	      playlist.state.addField = false;
	      playlist.state.addButton = true;
	    }
	    
	  }])

/***/ },
/* 13 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('scSearch', ['songConstructor', function (songConstructor) {
	    
	    var search = {
	      allTracks: allTracks
	    }; 
	
	    return search
	
	    function allTracks (input) {
	      var query = input;
	      function getUrl (urlStream) {
	        if (urlStream.length === 50) {
	          return urlStream.slice(-16, -7);
	        }
	        else if (urlStream.length === 49) {
	          return urlStream.slice(-15, -7)
	        }
	      }
	      
	      SC.get('/tracks', {q: query, limit: 20}).then(function(tracks) { 
	        vm.tracks = [];    
	        var trackResults = tracks;      
	        _.map(trackResults, function (each, i) {
	          var stream = each.stream_url;
	          var url = getUrl(stream);       
	          vm.tracks.push(new songConstructor(i, each.title, each.artwork_url, each.album, each.user.username, each.duration, 'soundcloud', each.stream_url, url, each.permalink_url))       
	        });
	        vm.digest()
	      })    
	    };
	    
	  }])

/***/ },
/* 14 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('searchType', [function () {
	
	    var search = {
	      changeSearch: changeSearch,
	      searchState: {
	        sc: true,
	        spotify: false
	      }
	    };  
	
	    return search  
	    
	    function changeSearch (attribute) {
	      
	      if (attribute === 'sc' && search.searchState.sc === false) {
	        search.searchState.sc = true;
	        search.searchState.spotify = false;
	      }
	      else if (attribute === 'spotify' && search.searchState.spotify === false) {
	        search.searchState.spotify = true;
	        search.searchState.sc = false;
	      }
	    }
	    
	  }])
	  

/***/ },
/* 15 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('songConstructor', [function () {
	
	    return song;
	
	    function song (key, name, image, album, artist, duration, company, fetchSource, urlSource, pageSource) {
	      this.key = key;
	      this.name = name;
	      this.image = image;
	      this.album = album;
	      this.artist = artist;
	      this.duration = duration;
	      this.company = company;
	      this.fetchSource = fetchSource;
	      this.urlSource = urlSource;
	      this.pageSource = pageSource;
	      this.deleteAble = {
	        state: false,
	        changeState: function () {
	          this.state = true;
	        }
	      }
	    }
	
	  }])


/***/ },
/* 16 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('spotifySearch', ['$http', 'songConstructor', function ($http, songConstructor) {
	      
	      var search = {
	        makeRequest: makeRequest
	      };
	
	      return search;
	
	      function makeRequest (input) {
	        var query = JSON.stringify({queryInput: input})
	        this.tracks = [];
	
	        $http({
	          data: query,
	          url: '/spotify',
	          method: 'POST'
	        }).then(function success (response) {       
	          trackResults = response.data.tracks.items;
	          _.map(trackResults, function (each, i) {
	            vm.tracks.push(
	              new songConstructor(i, each.name, each.album.images[1].url, each.album.name, each.artists[0].name, each.duration_ms, 'spotify', null, each.preview_url, each.external_urls.spotify)
	            );
	          })
	        })
	      } 
	      
	    }])

/***/ },
/* 17 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('tabs', [function () {
	
	    var tabSwitcher = {
	      switchTabs: switchTabs
	    };   
	
	    return tabSwitcher;
	
	    function switchTabs (tabAttribute) {
	      var allPages = document.getElementsByClassName('music-page');
	      var allTabs = document.getElementsByClassName('music-tab');
	
	      for (var i =0; i<allPages.length; i++) {
	        allPages[i].classList.add('hidden');
	        
	        if (allPages[i].getAttribute('data-page') === tabAttribute) {
	          allPages[i].classList.remove('hidden');
	        }
	      }
	    }
	  
	}])

/***/ },
/* 18 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('voice', [function () {
	    
	    var voice = {
	      initialize: initialize
	    };
	
	    return voice
	    
	    function initialize () {
	      if (annyang) {
	        var commands = {
	          'search *query': function search (query) {
	            vm.voiceSearch(query);
	          },
	          'start': function start () {
	            vm.voiceStart();
	          },
	          'play': function play () {
	            vm.voicePlay();
	          },        
	          'stop': function pause() {
	            vm.voicePause();
	          },
	          ':nomatch': function none (message) {
	            console.log('no recognized command')
	            return
	          }
	        };
	        annyang.addCommands(commands);
	        // annyang.start();
	      }  
	    }
	  
	}])

/***/ },
/* 19 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(20);


/***/ },
/* 20 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .controller('navController', navController); 
	
	  navController.$inject = ['$scope', 'userLogin'];
	
	  function navController ($scope, userLogin) {
	    var vm = this;
	    vm.loginName;
	    vm.loginPassword;
	    vm.currentUser;
	    vm.test = "test";
	
	    vm.login = function () {
	      var login = userLogin.login(vm.loginName, vm.loginPassword);
	      login.then(function (res) {
	        if (res.status === 200) {
	          var resData = JSON.parse(res.config.data);
	          vm.currentUser = resData.userName;
	        }
	      })
	    }
	  } 

/***/ },
/* 21 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(22);


/***/ },
/* 22 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .directive('navBar', function () {
	    return {
	      scope: true,
	      restrict: 'A',
	      replace: false,
	      templateUrl: 'templates/navigation.html',
	      link: function (scope, elem, attrs) {
	
	        $('.ui.modal').modal({
	          allowMultiple: false
	        })
	
	        $('#sign-up-btn').click(function () {
	          $('#sign-up-modal').modal('show')
	        })
	
	        $('#log-in-btn').click(function () {
	          $('#log-in-modal').modal('show')
	        })
	
	        $('#player-toggle').click(function () {
	          $('#player-menu').toggle('slide');
	        })
	      }
	    }
	  })

/***/ },
/* 23 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(19);
	__webpack_require__(21);
	__webpack_require__(24);


/***/ },
/* 24 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(25);


/***/ },
/* 25 */
/***/ function(module, exports) {

	angular.module('musicApp')
	  .factory('userLogin', ['$http', function ($http) {
	
	    return {
	      login: login
	    }
	
	    function login (userName, password) {
	
	      var query = JSON.stringify({
	        userName: userName,
	        password: password
	      })
	
	       return $http({
	        data: query,
	        url: '/users/login',
	        method: 'POST'
	      })
	
	    }
	
	  }])

/***/ },
/* 26 */
/***/ function(module, exports) {

	angular.module('musicApp', []);

/***/ },
/* 27 */
/***/ function(module, exports, __webpack_require__) {

	var map = {
		"./animations/index.js": 2,
		"./music/controller/index.js": 4,
		"./music/directive/index.js": 6,
		"./music/index.js": 8,
		"./music/service/index.js": 9,
		"./navigation/controller/index.js": 19,
		"./navigation/directive/index.js": 21,
		"./navigation/index.js": 23,
		"./navigation/service/index.js": 24
	};
	function webpackContext(req) {
		return __webpack_require__(webpackContextResolve(req));
	};
	function webpackContextResolve(req) {
		return map[req] || (function() { throw new Error("Cannot find module '" + req + "'.") }());
	};
	webpackContext.keys = function webpackContextKeys() {
		return Object.keys(map);
	};
	webpackContext.resolve = webpackContextResolve;
	module.exports = webpackContext;
	webpackContext.id = 27;


/***/ }
/******/ ]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgZDIxMTBiNDUwZDZjMmM0NzFhYTUiLCJ3ZWJwYWNrOi8vLy4vc3JjL2VudHJ5LmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9hbmltYXRpb25zL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9hbmltYXRpb25zL2FuaW1hdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbXVzaWMvY29udHJvbGxlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbXVzaWMvY29udHJvbGxlci9tdXNpYy5jb250cm9sbGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9kaXJlY3RpdmUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL211c2ljL2RpcmVjdGl2ZS9zb25nLWxpc3QuZGlyZWN0aXZlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbXVzaWMvc2VydmljZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbXVzaWMvc2VydmljZS9wbGF5ZXItY29udHJvbHMuc2VydmljZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbXVzaWMvc2VydmljZS9wbGF5bGlzdC1jb25zdHJ1Y3Rvci5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3BsYXlsaXN0cy5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3NjLXNlYXJjaC5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3NlYXJjaC10eXBlLnNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL211c2ljL3NlcnZpY2Uvc29uZy1jb25zdHJ1Y3Rvci5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3Nwb3RpZnktc2VhcmNoLnNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL211c2ljL3NlcnZpY2UvdGFicy5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3ZvaWNlLnNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL25hdmlnYXRpb24vY29udHJvbGxlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbmF2aWdhdGlvbi9jb250cm9sbGVyL25hdmlnYXRpb24uY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvbmF2aWdhdGlvbi9kaXJlY3RpdmUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL25hdmlnYXRpb24vZGlyZWN0aXZlL25hdmlnYXRpb24uZGlyZWN0aXZlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9uYXZpZ2F0aW9uL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9uYXZpZ2F0aW9uL3NlcnZpY2UvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL25hdmlnYXRpb24vc2VydmljZS9sb2dpbi5zZXJ2aWNlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9tdXNpYy1hcHAubW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9qcyBeXFwuXFwvLipcXC9pbmRleFxcLmpzJCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7OztBQ3RDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7OztBQ1ZBOzs7Ozs7O0FDQUEsZ0M7QUFDQTtBQUNBO0FBQ0EsSUFBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQztBQUNBO0FBQ0EsSUFBRztBQUNILEVBQUM7Ozs7Ozs7Ozs7QUNaRDs7Ozs7OztBQ0FBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRDtBQUNBO0FBQ0Esd0Q7QUFDQSx1Qzs7QUFFQSxzQkFBcUIsOENBQThDOztBQUVuRTtBQUNBLHNCO0FBQ0EsMEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUTtBQUNBO0FBQ0E7QUFDQSxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDO0FBQ0E7QUFDQTtBQUNBLFE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEO0FBQ0E7QUFDQSxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUTtBQUNBO0FBQ0E7QUFDQSxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw0QztBQUNBLDJEO0FBQ0E7QUFDQSxRO0FBQ0E7Ozs7Ozs7QUMzSEE7Ozs7Ozs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEM7QUFDQSwwRDtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsSUFBRyxDOzs7Ozs7QUNiSDtBQUNBO0FBQ0E7Ozs7Ozs7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQ1RBO0FBQ0EsNEM7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQOztBQUVBOztBQUVBLElBQUcsRTs7Ozs7O0FDdklIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsSUFBRyxFOzs7Ozs7QUNWSDtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDBDO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0EsMEM7QUFDQTtBQUNBO0FBQ0Esc0Q7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLElBQUcsRTs7Ozs7O0FDNUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE87O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMEJBQXlCLG9CQUFvQix5QjtBQUM3Qyx3QjtBQUNBLG1DO0FBQ0E7QUFDQTtBQUNBLG9DO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQSxRQUFPO0FBQ1A7O0FBRUEsSUFBRyxFOzs7Ozs7QUNoQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxJQUFHOzs7Ozs7O0FDekJIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLElBQUc7Ozs7Ozs7QUN4Qkg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxxQ0FBb0Msa0JBQWtCO0FBQ3REOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUyxvQztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1gsVUFBUztBQUNULFE7O0FBRUEsTUFBSyxFOzs7Ozs7QUMzQkw7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEscUJBQW9CLG1CQUFtQjtBQUN2Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLEVBQUMsRTs7Ozs7O0FDdEJEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBLFlBQVc7QUFDWDtBQUNBO0FBQ0EsWUFBVztBQUNYO0FBQ0E7QUFDQSxZQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRO0FBQ0E7O0FBRUEsRUFBQyxFOzs7Ozs7QUNsQ0Q7Ozs7Ozs7QUNBQTtBQUNBLCtDOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBLEk7Ozs7OztBQ3JCQTs7Ozs7OztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVM7O0FBRVQ7QUFDQTtBQUNBLFVBQVM7O0FBRVQ7QUFDQTtBQUNBLFVBQVM7O0FBRVQ7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0EsSUFBRyxDOzs7Ozs7QUMxQkg7QUFDQTtBQUNBOzs7Ozs7O0FDRkE7Ozs7Ozs7QUNBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBTzs7QUFFUDs7QUFFQSxJQUFHLEU7Ozs7OztBQ3RCSCxnQzs7Ozs7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWlDLHVEQUF1RDtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgZDIxMTBiNDUwZDZjMmM0NzFhYTVcbiAqKi8iLCIvL0NvbmNhdGVuYXRlcyBhbGwgbWFpbiBpbmRleCBmaWxlcyBmcm9tIGVhY2ggZGlyZWN0b3J5LlxuXG5mdW5jdGlvbiBhZGRJbmRleCAoZGlyZWN0b3J5KSB7XG4gcmV0dXJuIHJlcXVpcmUoJy4vanMvJyArIGRpcmVjdG9yeSArICcvaW5kZXguanMnKTtcbn07XG5cbnJlcXVpcmUoJy4vanMvbXVzaWMtYXBwLm1vZHVsZS5qcycpO1xuXG5hZGRJbmRleCgnbXVzaWMnKTtcbmFkZEluZGV4KCduYXZpZ2F0aW9uJyk7XG5hZGRJbmRleCgnYW5pbWF0aW9ucycpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9lbnRyeS5qc1xuICoqIG1vZHVsZSBpZCA9IDBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoJy4vYW5pbWF0aW9uLmpzJyk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL2FuaW1hdGlvbnMvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7ICBcbiAgJCgnLmFydGlzdC1ib3gnKS5kaW1tZXIoe1xuICAgIG9uOiAnaG92ZXInXG4gIH0pXG4gICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xuICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDg3MCkge1xuICAgICAgJCgnI3BsYXllci1tZW51JykuaGlkZSgpO1xuICAgIH1cbiAgICBlbHNlIGlmICgkKHdpbmRvdykud2lkdGgoKSA+IDg3MCkge1xuICAgICAgJCgnI3BsYXllci1tZW51Jykuc2hvdygpOyAgICAgICBcbiAgICB9XG4gIH0pXG59KVxuXG5cblxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9hbmltYXRpb25zL2FuaW1hdGlvbi5qc1xuICoqIG1vZHVsZSBpZCA9IDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoJy4vbXVzaWMuY29udHJvbGxlci5qcycpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9tdXNpYy9jb250cm9sbGVyL2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gNFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiYW5ndWxhci5tb2R1bGUoJ211c2ljQXBwJylcbiAgLmNvbnRyb2xsZXIoJ211c2ljUGxheWVyJywgbXVzaWNQbGF5ZXIpXG4gICAgXG4gIG11c2ljUGxheWVyLiRpbmplY3QgPSBbJyRzY29wZScsJyRodHRwJywgJ3Nwb3RpZnlTZWFyY2gnLCAncGxheWVyQ29udHJvbHMnLCAnc2NTZWFyY2gnLCAndGFicycsICdwbGF5bGlzdHMnLCAnc2VhcmNoVHlwZScsICd2b2ljZSddO1xuXG4gIGZ1bmN0aW9uIG11c2ljUGxheWVyICgkc2NvcGUsICRodHRwLCBzcG90aWZ5U2VhcmNoLCBwbGF5ZXJDb250cm9scywgc2NTZWFyY2gsIHRhYnMsIHBsYXlsaXN0cywgc2VhcmNoVHlwZSwgdm9pY2UpIHtcbiAgICAgIHZtID0gdGhpcztcbiAgICAgIHZtLnRvcEFydGlzdHM7XG4gICAgICB2bS50cmFja3MgPSBbXTtcbiAgICAgIHZtLnBsYXlsaXN0VGFicyA9IHBsYXlsaXN0cy5jdXJyZW50UGxheWxpc3RzO1xuICAgICAgdm0ucGxheWVySW1hZ2UgPSAnYXNzZXRzL2ltYWdlcy9tdXNpYy1wbGF5ZXIvZGVmYXVsdC1hbGJ1bS5wbmcnO1xuICAgICAgdm0ucGxheWVyVGl0bGUgPSAnVGl0bGUnO1xuICAgICAgdm0ucGxheWVyQXJ0aXN0ID0gJ0FydGlzdCc7XG4gICAgICB2bS5wbGF5ZXJJbmZvID0gJ2FsYnVtJztcbiAgICAgIHZtLnBsYXlTdGF0ZUJ1dHRvbiA9ICdwbGF5IGljb24nO1xuICAgICAgdm0uc2VhcmNoRGlzcGxheSA9IHNlYXJjaFR5cGUuc2VhcmNoU3RhdGU7IFxuICAgICAgdm0uYWRkUGxheWxpc3RTdGF0ZSA9IHBsYXlsaXN0cy5zdGF0ZS5hZGRGaWVsZDtcbiAgICAgIHZtLmFkZFBsYXlsaXN0QnV0dG9uID0gcGxheWxpc3RzLnN0YXRlLmFkZEJ1dHRvbjsgXG4gICAgICB2bS5hbm55YW5nID0gdm9pY2UuaW5pdGlhbGl6ZSgpOyAgXG4gICAgICBcbiAgICAgIFNDLmluaXRpYWxpemUoe2NsaWVudF9pZDogJ2IxMGE5ZTc3MDAzZGU2NzZhNDBiY2Q0Y2U3MzQ2ZjAzJ30pICBcbiAgICAgIFxuICAgICAgJHNjb3BlLnNwb3RpZnlRdWVyeTtcbiAgICAgICRzY29wZS5zY1F1ZXJ5OyBcbiAgICAgICRzY29wZS5uZXdQbGF5bGlzdDsgXG5cbiAgICAgIHZtLmRpZ2VzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgXy5kZWZlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgdm0udG9nZ2xlUGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcGxheWVyQ29udHJvbHMudG9nZ2xlUGxheSgpO1xuICAgICAgfSBcbiAgICAgIHZtLnBsYXlOZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwbGF5ZXJDb250cm9scy5uZXh0U29uZygpO1xuICAgICAgfVxuICAgICAgdm0ucGxheVByZXZpb3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwbGF5ZXJDb250cm9scy5wcmV2aW91c1NvbmcoKTtcbiAgICAgIH1cbiAgICAgIHZtLnZvaWNlUGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcGxheWVyQ29udHJvbHMudm9pY2VQbGF5KCk7XG4gICAgICB9XG4gICAgICB2bS52b2ljZVBhdXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwbGF5ZXJDb250cm9scy52b2ljZVBhdXNlKCk7XG4gICAgICB9IFxuICAgICAgdm0udm9pY2VTdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcGxheWVyQ29udHJvbHMudm9pY2VTdGFydCgpO1xuICAgICAgfSAgICAgXG4gICAgICB2bS5jaGFuZ2VTZWFyY2ggPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VhcmNoJyk7XG4gICAgICAgIHNlYXJjaFR5cGUuY2hhbmdlU2VhcmNoKGF0dHJpYnV0ZSlcbiAgICAgIH1cbiAgICAgIHZtLnN3aXRjaFRhYnMgPSBmdW5jdGlvbiAoZXZlbnQsIHBsYXlsaXN0KSB7XG4gICAgICAgIHZhciBhdHRyaWJ1dGUgPSBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXRhYicpO1xuICAgICAgICB2YXIgaXNQbGF5bGlzdCA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGxheWxpc3QnKTtcbiAgICAgICAgaWYgKGlzUGxheWxpc3QpIHtcbiAgICAgICAgICBwbGF5bGlzdHMuZGlzcGxheVRyYWNrcyhwbGF5bGlzdCk7ICAgICBcbiAgICAgICAgfVxuICAgICAgICB0YWJzLnN3aXRjaFRhYnMoYXR0cmlidXRlKTtcbiAgICAgIH0gICAgXG4gICAgICB2bS5yZXZlYWxOZXdQbGF5bGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcGxheWxpc3RzLnJldmVhbEFkZEZpZWxkKCk7XG4gICAgICAgIHZtLmFkZFBsYXlsaXN0U3RhdGUgPSBwbGF5bGlzdHMuc3RhdGUuYWRkRmllbGQ7XG4gICAgICAgIHZtLmFkZFBsYXlsaXN0QnV0dG9uID0gcGxheWxpc3RzLnN0YXRlLmFkZEJ1dHRvbjtcbiAgICAgIH1cbiAgICAgIHZtLmNyZWF0ZU5ld1BsYXlsaXN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgaWYgKCRzY29wZS5uZXdQbGF5bGlzdCA9PT0gXCJcIiB8fCAkc2NvcGUubmV3UGxheWxpc3QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgYWxlcnQoJ3BsZWFzZSBlbnRlciBwbGF5bGlzdCBuYW1lJylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcGxheWxpc3RzLmNyZWF0ZU5ld1BsYXlsaXN0KCRzY29wZS5uZXdQbGF5bGlzdCk7XG4gICAgICAgICAgJHNjb3BlLm5ld1BsYXlsaXN0PSBcIlwiO1xuICAgICAgICAgIHZtLmFkZFBsYXlsaXN0U3RhdGUgPSBwbGF5bGlzdHMuc3RhdGUuYWRkRmllbGQ7XG4gICAgICAgICAgdm0uYWRkUGxheWxpc3RCdXR0b24gPSBwbGF5bGlzdHMuc3RhdGUuYWRkQnV0dG9uO1xuICAgICAgICAgIHZtLmRpZ2VzdCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2bS5vcGVuRHJvcERvd24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJy51aS5kcm9wZG93bicpLmRyb3Bkb3duKCdyZXN0b3JlIGRlZmF1bHRzJyk7IFxuICAgICAgICB2bS5kaWdlc3QoKTtcbiAgICAgIH0gXG4gICAgICB2bS5hZGRUcmFjayA9IGZ1bmN0aW9uICh0cmFja0tleSwgcGxheWxpc3QpIHtcbiAgICAgICAgcGxheWxpc3RzLmFkZFRyYWNrKHRyYWNrS2V5LCBwbGF5bGlzdCk7XG4gICAgICAgIHZtLmRpZ2VzdCgpO1xuICAgICAgfSBcbiAgICAgIHZtLnJlbW92ZVRyYWNrID0gZnVuY3Rpb24gKHRyYWNrSWQpIHtcbiAgICAgICAgcGxheWxpc3RzLnJlbW92ZVRyYWNrKHRyYWNrSWQpO1xuICAgICAgfSAgICAgICAgICBcbiAgICAgIHZtLnZvaWNlU2VhcmNoID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBhdHRyaWJ1dGUgPSAnc2VhcmNoJztcbiAgICAgICAgICB0YWJzLnN3aXRjaFRhYnMoYXR0cmlidXRlKTtcbiAgICAgICAgICBzY1NlYXJjaC5hbGxUcmFja3MocXVlcnkpO1xuICAgICAgICAgICRzY29wZS5zY1F1ZXJ5ID0gXCJcIjtcbiAgICAgIH1cbiAgICAgIHZtLnNjU2VhcmNoRW50ZXIgPSBmdW5jdGlvbiAoKSB7ICAgICAgICAgICAgXG4gICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXRhYicpO1xuICAgICAgICAgIHRhYnMuc3dpdGNoVGFicyhhdHRyaWJ1dGUpO1xuICAgICAgICAgIHNjU2VhcmNoLmFsbFRyYWNrcygkc2NvcGUuc2NRdWVyeSk7XG4gICAgICAgICAgJHNjb3BlLnNjUXVlcnkgPSBcIlwiO1xuICAgICAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDg3MCkge1xuICAgICAgICAgICAgJCgnI3BsYXllci1tZW51JykuaGlkZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0gICBcbiAgICAgIHZtLnNwb3RpZnlTZWFyY2hFbnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiJyk7XG4gICAgICAgICAgdGFicy5zd2l0Y2hUYWJzKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgc3BvdGlmeVNlYXJjaC5tYWtlUmVxdWVzdCgkc2NvcGUuc3BvdGlmeVF1ZXJ5KTtcbiAgICAgICAgICAkc2NvcGUuc3BvdGlmeVF1ZXJ5ID0gXCJcIjtcbiAgICAgICAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA4NzApIHtcbiAgICAgICAgICAgICQoJyNwbGF5ZXItbWVudScpLmhpZGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgJHNjb3BlLnBsYXlNdXNpYyA9IGZ1bmN0aW9uIChldmVudCkgeyBcbiAgICAgICAgdmFyIHNvbmcgPSBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXNvbmcnKTsgICAgIFxuICAgICAgICBwbGF5ZXJDb250cm9scy5wbGF5TXVzaWMoc29uZyk7XG4gICAgICB9ICAgIFxuICB9XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL211c2ljL2NvbnRyb2xsZXIvbXVzaWMuY29udHJvbGxlci5qc1xuICoqIG1vZHVsZSBpZCA9IDVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoJy4vc29uZy1saXN0LmRpcmVjdGl2ZS5qcycpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9tdXNpYy9kaXJlY3RpdmUvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSA2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuZGlyZWN0aXZlKCdzb25nTGlzdCcsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2NvcGU6IHRydWUsXG4gICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90cmFjay1saXN0Lmh0bWwnLFxuICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgICBlbGVtLmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7ICAgXG4gICAgICAgICAgJCgnLnVpLmRyb3Bkb3duJykuZHJvcGRvd24oJ3Jlc3RvcmUgZGVmYXVsdHMnKTsgICAgICAgICAgICBcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9tdXNpYy9kaXJlY3RpdmUvc29uZy1saXN0LmRpcmVjdGl2ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoJy4vY29udHJvbGxlci9pbmRleC5qcycpO1xucmVxdWlyZSgnLi9kaXJlY3RpdmUvaW5kZXguanMnKTtcbnJlcXVpcmUoJy4vc2VydmljZS9pbmRleC5qcycpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9tdXNpYy9pbmRleC5qc1xuICoqIG1vZHVsZSBpZCA9IDhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoJy4vcGxheWVyLWNvbnRyb2xzLnNlcnZpY2UuanMnKTtcbnJlcXVpcmUoJy4vcGxheWxpc3QtY29uc3RydWN0b3Iuc2VydmljZS5qcycpO1xucmVxdWlyZSgnLi9wbGF5bGlzdHMuc2VydmljZS5qcycpO1xucmVxdWlyZSgnLi9zYy1zZWFyY2guc2VydmljZS5qcycpO1xucmVxdWlyZSgnLi9zZWFyY2gtdHlwZS5zZXJ2aWNlLmpzJyk7XG5yZXF1aXJlKCcuL3NvbmctY29uc3RydWN0b3Iuc2VydmljZS5qcycpO1xucmVxdWlyZSgnLi9zcG90aWZ5LXNlYXJjaC5zZXJ2aWNlLmpzJyk7XG5yZXF1aXJlKCcuL3Nwb3RpZnktc2VhcmNoLnNlcnZpY2UuanMnKTtcbnJlcXVpcmUoJy4vdGFicy5zZXJ2aWNlLmpzJyk7XG5yZXF1aXJlKCcuL3ZvaWNlLnNlcnZpY2UuanMnKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMvbXVzaWMvc2VydmljZS9pbmRleC5qc1xuICoqIG1vZHVsZSBpZCA9IDlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImFuZ3VsYXIubW9kdWxlKCdtdXNpY0FwcCcpXG4gIC5mYWN0b3J5KCdwbGF5ZXJDb250cm9scycsIFtmdW5jdGlvbiAoKSB7IFxuICAgIFxuICAgIHZhciBtYXN0ZXJQbGF5ZXIgPSBuZXcgQXVkaW8oKTtcblxuICAgIG1hc3RlclBsYXllci5wbGF5U3RhdGUgPSB7XG4gICAgICBwbGF5aW5nOiBmYWxzZSxcbiAgICAgIGN1cnJlbnRTb25nOiBudWxsXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U29uZyAoc29uZykge1xuICAgICAgc2NDbGllbnQgPSAnYjEwYTllNzcwMDNkZTY3NmE0MGJjZDRjZTczNDZmMDMnXG4gICAgICBpZiAoc29uZy5jb21wYW55ID09PSAnc291bmRjbG91ZCcpIHtcbiAgICAgICAgcmV0dXJuICdodHRwczovL2FwaS5zb3VuZGNsb3VkLmNvbS90cmFja3MvJyArIHNvbmcudXJsU291cmNlICsgJy9zdHJlYW0/Y2xpZW50X2lkPScgKyBzY0NsaWVudDtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHNvbmcuY29tcGFueSA9PT0gJ3Nwb3RpZnknKSB7XG4gICAgICAgIHJldHVybiBzb25nLnVybFNvdXJjZTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gc2V0Q3VycmVudCAoY3VycmVudFNvbmcpIHtcbiAgICAgIHZhciBzb25nS2V5ID0gY3VycmVudFNvbmcua2V5O1xuICAgICAgbWFzdGVyUGxheWVyLnBsYXlTdGF0ZS5jdXJyZW50U29uZyA9IHNvbmdLZXk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0UGxheWVySW5mbyhjdXJyZW50U29uZykge1xuICAgICAgdm0ucGxheWVySW1hZ2UgPSBjdXJyZW50U29uZy5pbWFnZTtcbiAgICAgIHZtLnBsYXllclRpdGxlID0gY3VycmVudFNvbmcubmFtZTtcbiAgICAgIHZtLnBsYXllckFydGlzdCA9IGN1cnJlbnRTb25nLmFydGlzdDtcbiAgICAgIHZtLnBsYXllckluZm8gPSBjdXJyZW50U29uZy5hbGJ1bTsgXG4gICAgfVxuICAgIFxuICAgIG1hc3RlclBsYXllci5uZXh0U29uZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjdXJyZW50ID0gbWFzdGVyUGxheWVyLnBsYXlTdGF0ZS5jdXJyZW50U29uZztcbiAgICAgIHZhciBuZXh0ID0gY3VycmVudCArIDE7XG5cbiAgICAgIGlmIChtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPT09IHRydWUgJiYgdm0udHJhY2tzW25leHRdKSB7XG4gICAgICAgIG1hc3RlclBsYXllci5zcmMgPSBnZXRTb25nKHZtLnRyYWNrc1tuZXh0XSk7XG4gICAgICAgIHNldFBsYXllckluZm8odm0udHJhY2tzW25leHRdKTtcbiAgICAgICAgc2V0Q3VycmVudCh2bS50cmFja3NbbmV4dF0pO1xuICAgICAgICBtYXN0ZXJQbGF5ZXIucGxheSgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoISh2bS50cmFja3NbbmV4dF0pKSB7XG4gICAgICAgIG1hc3RlclBsYXllci5zcmMgPSBnZXRTb25nKHZtLnRyYWNrc1swXSk7XG4gICAgICAgIHNldFBsYXllckluZm8odm0udHJhY2tzWzBdKTtcbiAgICAgICAgc2V0Q3VycmVudCh2bS50cmFja3NbMF0pO1xuICAgICAgICBtYXN0ZXJQbGF5ZXIucGxheSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG1hc3RlclBsYXllci5wcmV2aW91c1NvbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgY3VycmVudCA9IG1hc3RlclBsYXllci5wbGF5U3RhdGUuY3VycmVudFNvbmc7XG4gICAgICB2YXIgcHJldmlvdXMgPSBjdXJyZW50IC0gMTtcbiAgICAgIFxuICAgICAgaWYgKG1hc3RlclBsYXllci5wbGF5U3RhdGUucGxheWluZyA9PT0gdHJ1ZSAmJiB2bS50cmFja3NbcHJldmlvdXNdKSB7XG4gICAgICAgIG1hc3RlclBsYXllci5zcmMgPSBnZXRTb25nKHZtLnRyYWNrc1twcmV2aW91c10pO1xuICAgICAgICBzZXRQbGF5ZXJJbmZvKHZtLnRyYWNrc1twcmV2aW91c10pO1xuICAgICAgICBzZXRDdXJyZW50KHZtLnRyYWNrc1twcmV2aW91c10pO1xuICAgICAgICBtYXN0ZXJQbGF5ZXIucGxheSgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoISh2bS50cmFja3NbcHJldmlvdXNdKSkge1xuICAgICAgICB2YXIgbGFzdFRyYWNrID0gdm0udHJhY2tzWygoMCAtIHZtLnRyYWNrcy5sZW5ndGgpKi0xKSAtIDFdO1xuICAgICAgICBtYXN0ZXJQbGF5ZXIuc3JjID0gZ2V0U29uZyhsYXN0VHJhY2spO1xuICAgICAgICBzZXRQbGF5ZXJJbmZvKGxhc3RUcmFjayk7XG4gICAgICAgIHNldEN1cnJlbnQobGFzdFRyYWNrKTtcbiAgICAgICAgbWFzdGVyUGxheWVyLnBsYXkoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBtYXN0ZXJQbGF5ZXIudG9nZ2xlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAobWFzdGVyUGxheWVyLnBsYXlTdGF0ZS5wbGF5aW5nID09PSBmYWxzZSkge1xuICAgICAgICBtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPSB0cnVlO1xuICAgICAgICB2bS5wbGF5U3RhdGVCdXR0b24gPSAncGF1c2UgaWNvbic7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPT09IHRydWUpIHtcbiAgICAgICAgbWFzdGVyUGxheWVyLnBsYXlTdGF0ZS5wbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHZtLnBsYXlTdGF0ZUJ1dHRvbiA9ICdwbGF5IGljb24nO1xuICAgICAgICBcbiAgICAgIH1cbiAgICB9XG4gICAgbWFzdGVyUGxheWVyLnZvaWNlUGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPT09IGZhbHNlKSB7XG4gICAgICAgIG1hc3RlclBsYXllci5wbGF5KCk7XG4gICAgICAgIG1hc3RlclBsYXllci50b2dnbGVTdGF0ZSgpO1xuICAgICAgICB2bS5kaWdlc3QoKTtcbiAgICAgIH0gICAgICBcbiAgICB9XG5cbiAgICBtYXN0ZXJQbGF5ZXIudm9pY2VQYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPT09IHRydWUpIHtcbiAgICAgICAgbWFzdGVyUGxheWVyLnBhdXNlKCk7XG4gICAgICAgIG1hc3RlclBsYXllci50b2dnbGVTdGF0ZSgpO1xuICAgICAgICB2bS5kaWdlc3QoKTtcbiAgICAgIH0gICAgICBcbiAgICB9XG5cbiAgICBtYXN0ZXJQbGF5ZXIudm9pY2VTdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh2bS50cmFja3MubGVuZ3RoID4gMSAmJiBtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPT09IGZhbHNlKSB7XG4gICAgICAgIG1hc3RlclBsYXllci5zcmMgPSBnZXRTb25nKHZtLnRyYWNrc1swXSk7XG4gICAgICAgIHNldFBsYXllckluZm8odm0udHJhY2tzWzBdKTsgXG4gICAgICAgIHNldEN1cnJlbnQodm0udHJhY2tzWzBdKTtcbiAgICAgICAgbWFzdGVyUGxheWVyLnBsYXkoKTtcbiAgICAgICAgbWFzdGVyUGxheWVyLnRvZ2dsZVN0YXRlKCk7XG4gICAgICAgIHZtLmRpZ2VzdCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG1hc3RlclBsYXllci50b2dnbGVQbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHZtLnRyYWNrcy5sZW5ndGggPiAxICYmIG1hc3RlclBsYXllci5zcmMgPT09ICcnKSB7XG4gICAgICAgIG1hc3RlclBsYXllci5zcmMgPSBnZXRTb25nKHZtLnRyYWNrc1swXSk7XG4gICAgICAgIHNldFBsYXllckluZm8odm0udHJhY2tzWzBdKTsgXG4gICAgICAgIHNldEN1cnJlbnQodm0udHJhY2tzWzBdKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG1hc3RlclBsYXllci5zcmMgPT09ICcnKSB7XG4gICAgICAgIHJldHVyblxuICAgICAgfTsgICAgICBcbiAgICAgIChtYXN0ZXJQbGF5ZXIucGxheVN0YXRlLnBsYXlpbmcgPT09IGZhbHNlKSA/IG1hc3RlclBsYXllci5wbGF5KCkgOiBtYXN0ZXJQbGF5ZXIucGF1c2UoKTtcbiAgICAgIG1hc3RlclBsYXllci50b2dnbGVTdGF0ZSgpO1xuICAgICAgdm0uZGlnZXN0KCk7XG4gICAgfVxuXG4gICAgbWFzdGVyUGxheWVyLnBsYXlNdXNpYyA9IGZ1bmN0aW9uIChzb25nKSB7XG4gICAgICBfLmVhY2godm0udHJhY2tzLCBmdW5jdGlvbiAoZWFjaFNvbmcpIHtcbiAgICAgICAgaWYgKGVhY2hTb25nLm5hbWUgPT09IHNvbmcpIHtcbiAgICAgICAgICBzZXRDdXJyZW50KGVhY2hTb25nKTsgICBcbiAgICAgICAgICBzZXRQbGF5ZXJJbmZvKGVhY2hTb25nKTtcbiAgICAgICAgICBtYXN0ZXJQbGF5ZXIuc3JjID0gZ2V0U29uZyhlYWNoU29uZyk7XG4gICAgICAgICAgKG1hc3RlclBsYXllci5wbGF5U3RhdGUucGxheWluZyA9PT0gZmFsc2UpID8gbWFzdGVyUGxheWVyLnRvZ2dsZVBsYXkoKSA6IG1hc3RlclBsYXllci5wbGF5KCk7XG4gICAgICAgICAgdm0uZGlnZXN0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gIHJldHVybiBtYXN0ZXJQbGF5ZXJcbiAgICBcbiAgfV0pXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3BsYXllci1jb250cm9scy5zZXJ2aWNlLmpzXG4gKiogbW9kdWxlIGlkID0gMTBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImFuZ3VsYXIubW9kdWxlKCdtdXNpY0FwcCcpXG4gIC5mYWN0b3J5KCdwbGF5bGlzdENvbnN0cnVjdG9yJywgW2Z1bmN0aW9uICgpIHtcblxuICAgIHJldHVybiBwbGF5bGlzdFxuXG4gICAgZnVuY3Rpb24gcGxheWxpc3QgKG5hbWUpIHtcbiAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICB0aGlzLnRyYWNrcyA9IFtdO1xuICAgIH1cbiAgICBcbiAgfV0pXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9tdXNpYy9zZXJ2aWNlL3BsYXlsaXN0LWNvbnN0cnVjdG9yLnNlcnZpY2UuanNcbiAqKiBtb2R1bGUgaWQgPSAxMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiYW5ndWxhci5tb2R1bGUoJ211c2ljQXBwJylcbiAgLmZhY3RvcnkoJ3BsYXlsaXN0cycsIFsncGxheWxpc3RDb25zdHJ1Y3RvcicsIGZ1bmN0aW9uIChwbGF5bGlzdENvbnN0cnVjdG9yKSB7XG4gICAgXG5cbiAgICB2YXIgc2FtcGxlUGxheWxpc3QgPSBuZXcgcGxheWxpc3RDb25zdHJ1Y3RvcignTXkgUGxheWxpc3QnKTtcblxuICAgIHZhciBwbGF5bGlzdCA9IHtcbiAgICAgIGFkZFRyYWNrOiBhZGRUcmFjayxcbiAgICAgIGNyZWF0ZU5ld1BsYXlsaXN0OiBjcmVhdGVOZXdQbGF5bGlzdCxcbiAgICAgIGRpc3BsYXlUcmFja3M6IGRpc3BsYXlUcmFja3MsXG4gICAgICByZW1vdmVUcmFjazogcmVtb3ZlVHJhY2ssXG4gICAgICByZXZlYWxBZGRGaWVsZDogcmV2ZWFsQWRkRmllbGQsICAgIFxuICAgICAgc3RhdGU6IHtcbiAgICAgICAgYWRkRmllbGQ6IGZhbHNlLFxuICAgICAgICBhZGRCdXR0b246IHRydWVcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcGxheWxpc3QuY3VycmVudFBsYXlsaXN0cyA9IFtzYW1wbGVQbGF5bGlzdF07XG5cbiAgICByZXR1cm4gcGxheWxpc3Q7XG5cbiAgICBmdW5jdGlvbiByZXZlYWxBZGRGaWVsZCAoKSB7XG4gICAgICAgIHBsYXlsaXN0LnN0YXRlLmFkZEZpZWxkID0gdHJ1ZTtcbiAgICAgICAgcGxheWxpc3Quc3RhdGUuYWRkQnV0dG9uID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRUcmFjayAodHJhY2tLZXksIHBsYXlsaXN0KSB7XG4gICAgICB2YXIgY3VycmVudFBsYXlsaXN0O1xuXG4gICAgICBfLm1hcCh2bS5wbGF5bGlzdFRhYnMsIGZ1bmN0aW9uIGZpbmRQbGF5bGlzdCAoZWFjaFBsYXlsaXN0KSB7XG4gICAgICAgIGlmIChlYWNoUGxheWxpc3QubmFtZSA9PT0gcGxheWxpc3QpIHtcbiAgICAgICAgICBjdXJyZW50UGxheWxpc3QgPSBlYWNoUGxheWxpc3Q7ICAgICAgICBcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgXy5tYXAodm0udHJhY2tzLCBmdW5jdGlvbiBmaW5kVHJhY2sgKGVhY2hUcmFjaykge1xuICAgICAgICBpZiAoZWFjaFRyYWNrLmtleSA9PT0gdHJhY2tLZXkpIHsgICAgICAgICAgXG4gICAgICAgICAgY3VycmVudFBsYXlsaXN0LnRyYWNrcy5wdXNoKGVhY2hUcmFjayk7XG4gICAgICAgICAgdmFyIHJlbW92ZWREdXBsaWNhdGVzID0gXy51bmlxKGN1cnJlbnRQbGF5bGlzdC50cmFja3MpO1xuICAgICAgICAgIGN1cnJlbnRQbGF5bGlzdC50cmFja3MgPSByZW1vdmVkRHVwbGljYXRlczsgICAgICAgIFxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZVRyYWNrICh0cmFja0lkKSB7XG4gICAgICB2bS50cmFja3MuZm9yRWFjaChmdW5jdGlvbiAodHJhY2ssIGkpIHtcbiAgICAgICAgaWYgKHRyYWNrLmtleSA9PT0gdHJhY2tJZCkge1xuICAgICAgICAgIHZtLnRyYWNrcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIH1cbiAgICAgIH0pIFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3BsYXlUcmFja3MgKHBsYXlsaXN0KSB7XG4gICAgICB2bS50cmFja3MgPSBbXTtcblxuICAgICAgXy5tYXAodm0ucGxheWxpc3RUYWJzLCBmdW5jdGlvbiAoZWFjaFBsYXlsaXN0LCBpKSB7XG4gICAgICAgIGlmIChlYWNoUGxheWxpc3QubmFtZSA9PT0gcGxheWxpc3QpIHtcbiAgICAgICAgICB2bS50cmFja3MgPSBlYWNoUGxheWxpc3QudHJhY2tzO1xuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBfLm1hcCh2bS50cmFja3MsIGZ1bmN0aW9uIChlYWNoVHJhY2ssIGkpIHtcbiAgICAgICAgZWFjaFRyYWNrLmRlbGV0ZUFibGUuY2hhbmdlU3RhdGUoKTtcbiAgICAgICAgZWFjaFRyYWNrLmtleSA9IGk7XG4gICAgICB9KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZU5ld1BsYXlsaXN0IChuYW1lKSB7XG4gICAgICB2YXIgbmV3UGxheWxpc3QgPSBuZXcgcGxheWxpc3RDb25zdHJ1Y3RvciAobmFtZSk7XG4gICAgICBcbiAgICAgIHBsYXlsaXN0LmN1cnJlbnRQbGF5bGlzdHMucHVzaChuZXdQbGF5bGlzdCk7XG4gICAgICBwbGF5bGlzdC5zdGF0ZS5hZGRGaWVsZCA9IGZhbHNlO1xuICAgICAgcGxheWxpc3Quc3RhdGUuYWRkQnV0dG9uID0gdHJ1ZTtcbiAgICB9XG4gICAgXG4gIH1dKVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMvbXVzaWMvc2VydmljZS9wbGF5bGlzdHMuc2VydmljZS5qc1xuICoqIG1vZHVsZSBpZCA9IDEyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuZmFjdG9yeSgnc2NTZWFyY2gnLCBbJ3NvbmdDb25zdHJ1Y3RvcicsIGZ1bmN0aW9uIChzb25nQ29uc3RydWN0b3IpIHtcbiAgICBcbiAgICB2YXIgc2VhcmNoID0ge1xuICAgICAgYWxsVHJhY2tzOiBhbGxUcmFja3NcbiAgICB9OyBcblxuICAgIHJldHVybiBzZWFyY2hcblxuICAgIGZ1bmN0aW9uIGFsbFRyYWNrcyAoaW5wdXQpIHtcbiAgICAgIHZhciBxdWVyeSA9IGlucHV0O1xuICAgICAgZnVuY3Rpb24gZ2V0VXJsICh1cmxTdHJlYW0pIHtcbiAgICAgICAgaWYgKHVybFN0cmVhbS5sZW5ndGggPT09IDUwKSB7XG4gICAgICAgICAgcmV0dXJuIHVybFN0cmVhbS5zbGljZSgtMTYsIC03KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1cmxTdHJlYW0ubGVuZ3RoID09PSA0OSkge1xuICAgICAgICAgIHJldHVybiB1cmxTdHJlYW0uc2xpY2UoLTE1LCAtNylcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBTQy5nZXQoJy90cmFja3MnLCB7cTogcXVlcnksIGxpbWl0OiAyMH0pLnRoZW4oZnVuY3Rpb24odHJhY2tzKSB7IFxuICAgICAgICB2bS50cmFja3MgPSBbXTsgICAgXG4gICAgICAgIHZhciB0cmFja1Jlc3VsdHMgPSB0cmFja3M7ICAgICAgXG4gICAgICAgIF8ubWFwKHRyYWNrUmVzdWx0cywgZnVuY3Rpb24gKGVhY2gsIGkpIHtcbiAgICAgICAgICB2YXIgc3RyZWFtID0gZWFjaC5zdHJlYW1fdXJsO1xuICAgICAgICAgIHZhciB1cmwgPSBnZXRVcmwoc3RyZWFtKTsgICAgICAgXG4gICAgICAgICAgdm0udHJhY2tzLnB1c2gobmV3IHNvbmdDb25zdHJ1Y3RvcihpLCBlYWNoLnRpdGxlLCBlYWNoLmFydHdvcmtfdXJsLCBlYWNoLmFsYnVtLCBlYWNoLnVzZXIudXNlcm5hbWUsIGVhY2guZHVyYXRpb24sICdzb3VuZGNsb3VkJywgZWFjaC5zdHJlYW1fdXJsLCB1cmwsIGVhY2gucGVybWFsaW5rX3VybCkpICAgICAgIFxuICAgICAgICB9KTtcbiAgICAgICAgdm0uZGlnZXN0KClcbiAgICAgIH0pICAgIFxuICAgIH07XG4gICAgXG4gIH1dKVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMvbXVzaWMvc2VydmljZS9zYy1zZWFyY2guc2VydmljZS5qc1xuICoqIG1vZHVsZSBpZCA9IDEzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuZmFjdG9yeSgnc2VhcmNoVHlwZScsIFtmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgc2VhcmNoID0ge1xuICAgICAgY2hhbmdlU2VhcmNoOiBjaGFuZ2VTZWFyY2gsXG4gICAgICBzZWFyY2hTdGF0ZToge1xuICAgICAgICBzYzogdHJ1ZSxcbiAgICAgICAgc3BvdGlmeTogZmFsc2VcbiAgICAgIH1cbiAgICB9OyAgXG5cbiAgICByZXR1cm4gc2VhcmNoICBcbiAgICBcbiAgICBmdW5jdGlvbiBjaGFuZ2VTZWFyY2ggKGF0dHJpYnV0ZSkge1xuICAgICAgXG4gICAgICBpZiAoYXR0cmlidXRlID09PSAnc2MnICYmIHNlYXJjaC5zZWFyY2hTdGF0ZS5zYyA9PT0gZmFsc2UpIHtcbiAgICAgICAgc2VhcmNoLnNlYXJjaFN0YXRlLnNjID0gdHJ1ZTtcbiAgICAgICAgc2VhcmNoLnNlYXJjaFN0YXRlLnNwb3RpZnkgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGF0dHJpYnV0ZSA9PT0gJ3Nwb3RpZnknICYmIHNlYXJjaC5zZWFyY2hTdGF0ZS5zcG90aWZ5ID09PSBmYWxzZSkge1xuICAgICAgICBzZWFyY2guc2VhcmNoU3RhdGUuc3BvdGlmeSA9IHRydWU7XG4gICAgICAgIHNlYXJjaC5zZWFyY2hTdGF0ZS5zYyA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgfV0pXG4gIFxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMvbXVzaWMvc2VydmljZS9zZWFyY2gtdHlwZS5zZXJ2aWNlLmpzXG4gKiogbW9kdWxlIGlkID0gMTRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImFuZ3VsYXIubW9kdWxlKCdtdXNpY0FwcCcpXG4gIC5mYWN0b3J5KCdzb25nQ29uc3RydWN0b3InLCBbZnVuY3Rpb24gKCkge1xuXG4gICAgcmV0dXJuIHNvbmc7XG5cbiAgICBmdW5jdGlvbiBzb25nIChrZXksIG5hbWUsIGltYWdlLCBhbGJ1bSwgYXJ0aXN0LCBkdXJhdGlvbiwgY29tcGFueSwgZmV0Y2hTb3VyY2UsIHVybFNvdXJjZSwgcGFnZVNvdXJjZSkge1xuICAgICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgdGhpcy5pbWFnZSA9IGltYWdlO1xuICAgICAgdGhpcy5hbGJ1bSA9IGFsYnVtO1xuICAgICAgdGhpcy5hcnRpc3QgPSBhcnRpc3Q7XG4gICAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICB0aGlzLmNvbXBhbnkgPSBjb21wYW55O1xuICAgICAgdGhpcy5mZXRjaFNvdXJjZSA9IGZldGNoU291cmNlO1xuICAgICAgdGhpcy51cmxTb3VyY2UgPSB1cmxTb3VyY2U7XG4gICAgICB0aGlzLnBhZ2VTb3VyY2UgPSBwYWdlU291cmNlO1xuICAgICAgdGhpcy5kZWxldGVBYmxlID0ge1xuICAgICAgICBzdGF0ZTogZmFsc2UsXG4gICAgICAgIGNoYW5nZVN0YXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhpcy5zdGF0ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgfV0pXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL211c2ljL3NlcnZpY2Uvc29uZy1jb25zdHJ1Y3Rvci5zZXJ2aWNlLmpzXG4gKiogbW9kdWxlIGlkID0gMTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImFuZ3VsYXIubW9kdWxlKCdtdXNpY0FwcCcpXG4gIC5mYWN0b3J5KCdzcG90aWZ5U2VhcmNoJywgWyckaHR0cCcsICdzb25nQ29uc3RydWN0b3InLCBmdW5jdGlvbiAoJGh0dHAsIHNvbmdDb25zdHJ1Y3Rvcikge1xuICAgICAgXG4gICAgICB2YXIgc2VhcmNoID0ge1xuICAgICAgICBtYWtlUmVxdWVzdDogbWFrZVJlcXVlc3RcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBzZWFyY2g7XG5cbiAgICAgIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0IChpbnB1dCkge1xuICAgICAgICB2YXIgcXVlcnkgPSBKU09OLnN0cmluZ2lmeSh7cXVlcnlJbnB1dDogaW5wdXR9KVxuICAgICAgICB0aGlzLnRyYWNrcyA9IFtdO1xuXG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICBkYXRhOiBxdWVyeSxcbiAgICAgICAgICB1cmw6ICcvc3BvdGlmeScsXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiBzdWNjZXNzIChyZXNwb25zZSkgeyAgICAgICBcbiAgICAgICAgICB0cmFja1Jlc3VsdHMgPSByZXNwb25zZS5kYXRhLnRyYWNrcy5pdGVtcztcbiAgICAgICAgICBfLm1hcCh0cmFja1Jlc3VsdHMsIGZ1bmN0aW9uIChlYWNoLCBpKSB7XG4gICAgICAgICAgICB2bS50cmFja3MucHVzaChcbiAgICAgICAgICAgICAgbmV3IHNvbmdDb25zdHJ1Y3RvcihpLCBlYWNoLm5hbWUsIGVhY2guYWxidW0uaW1hZ2VzWzFdLnVybCwgZWFjaC5hbGJ1bS5uYW1lLCBlYWNoLmFydGlzdHNbMF0ubmFtZSwgZWFjaC5kdXJhdGlvbl9tcywgJ3Nwb3RpZnknLCBudWxsLCBlYWNoLnByZXZpZXdfdXJsLCBlYWNoLmV4dGVybmFsX3VybHMuc3BvdGlmeSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH0gXG4gICAgICBcbiAgICB9XSlcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL211c2ljL3NlcnZpY2Uvc3BvdGlmeS1zZWFyY2guc2VydmljZS5qc1xuICoqIG1vZHVsZSBpZCA9IDE2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuZmFjdG9yeSgndGFicycsIFtmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgdGFiU3dpdGNoZXIgPSB7XG4gICAgICBzd2l0Y2hUYWJzOiBzd2l0Y2hUYWJzXG4gICAgfTsgICBcblxuICAgIHJldHVybiB0YWJTd2l0Y2hlcjtcblxuICAgIGZ1bmN0aW9uIHN3aXRjaFRhYnMgKHRhYkF0dHJpYnV0ZSkge1xuICAgICAgdmFyIGFsbFBhZ2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbXVzaWMtcGFnZScpO1xuICAgICAgdmFyIGFsbFRhYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtdXNpYy10YWInKTtcblxuICAgICAgZm9yICh2YXIgaSA9MDsgaTxhbGxQYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBhbGxQYWdlc1tpXS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChhbGxQYWdlc1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFnZScpID09PSB0YWJBdHRyaWJ1dGUpIHtcbiAgICAgICAgICBhbGxQYWdlc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgXG59XSlcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL211c2ljL3NlcnZpY2UvdGFicy5zZXJ2aWNlLmpzXG4gKiogbW9kdWxlIGlkID0gMTdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImFuZ3VsYXIubW9kdWxlKCdtdXNpY0FwcCcpXG4gIC5mYWN0b3J5KCd2b2ljZScsIFtmdW5jdGlvbiAoKSB7XG4gICAgXG4gICAgdmFyIHZvaWNlID0ge1xuICAgICAgaW5pdGlhbGl6ZTogaW5pdGlhbGl6ZVxuICAgIH07XG5cbiAgICByZXR1cm4gdm9pY2VcbiAgICBcbiAgICBmdW5jdGlvbiBpbml0aWFsaXplICgpIHtcbiAgICAgIGlmIChhbm55YW5nKSB7XG4gICAgICAgIHZhciBjb21tYW5kcyA9IHtcbiAgICAgICAgICAnc2VhcmNoICpxdWVyeSc6IGZ1bmN0aW9uIHNlYXJjaCAocXVlcnkpIHtcbiAgICAgICAgICAgIHZtLnZvaWNlU2VhcmNoKHF1ZXJ5KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgICdzdGFydCc6IGZ1bmN0aW9uIHN0YXJ0ICgpIHtcbiAgICAgICAgICAgIHZtLnZvaWNlU3RhcnQoKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgICdwbGF5JzogZnVuY3Rpb24gcGxheSAoKSB7XG4gICAgICAgICAgICB2bS52b2ljZVBsYXkoKTtcbiAgICAgICAgICB9LCAgICAgICAgXG4gICAgICAgICAgJ3N0b3AnOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIHZtLnZvaWNlUGF1c2UoKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgICc6bm9tYXRjaCc6IGZ1bmN0aW9uIG5vbmUgKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubyByZWNvZ25pemVkIGNvbW1hbmQnKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBhbm55YW5nLmFkZENvbW1hbmRzKGNvbW1hbmRzKTtcbiAgICAgICAgLy8gYW5ueWFuZy5zdGFydCgpO1xuICAgICAgfSAgXG4gICAgfVxuICBcbn1dKVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMvbXVzaWMvc2VydmljZS92b2ljZS5zZXJ2aWNlLmpzXG4gKiogbW9kdWxlIGlkID0gMThcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInJlcXVpcmUoJy4vbmF2aWdhdGlvbi5jb250cm9sbGVyLmpzJyk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL25hdmlnYXRpb24vY29udHJvbGxlci9pbmRleC5qc1xuICoqIG1vZHVsZSBpZCA9IDE5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuY29udHJvbGxlcignbmF2Q29udHJvbGxlcicsIG5hdkNvbnRyb2xsZXIpOyBcblxuICBuYXZDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICd1c2VyTG9naW4nXTtcblxuICBmdW5jdGlvbiBuYXZDb250cm9sbGVyICgkc2NvcGUsIHVzZXJMb2dpbikge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0ubG9naW5OYW1lO1xuICAgIHZtLmxvZ2luUGFzc3dvcmQ7XG4gICAgdm0uY3VycmVudFVzZXI7XG4gICAgdm0udGVzdCA9IFwidGVzdFwiO1xuXG4gICAgdm0ubG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgbG9naW4gPSB1c2VyTG9naW4ubG9naW4odm0ubG9naW5OYW1lLCB2bS5sb2dpblBhc3N3b3JkKTtcbiAgICAgIGxvZ2luLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgdmFyIHJlc0RhdGEgPSBKU09OLnBhcnNlKHJlcy5jb25maWcuZGF0YSk7XG4gICAgICAgICAgdm0uY3VycmVudFVzZXIgPSByZXNEYXRhLnVzZXJOYW1lO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfSBcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL25hdmlnYXRpb24vY29udHJvbGxlci9uYXZpZ2F0aW9uLmNvbnRyb2xsZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAyMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwicmVxdWlyZSgnLi9uYXZpZ2F0aW9uLmRpcmVjdGl2ZS5qcycpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9qcy9uYXZpZ2F0aW9uL2RpcmVjdGl2ZS9pbmRleC5qc1xuICoqIG1vZHVsZSBpZCA9IDIxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuZGlyZWN0aXZlKCduYXZCYXInLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3BlOiB0cnVlLFxuICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgIHJlcGxhY2U6IGZhbHNlLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbmF2aWdhdGlvbi5odG1sJyxcbiAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbSwgYXR0cnMpIHtcblxuICAgICAgICAkKCcudWkubW9kYWwnKS5tb2RhbCh7XG4gICAgICAgICAgYWxsb3dNdWx0aXBsZTogZmFsc2VcbiAgICAgICAgfSlcblxuICAgICAgICAkKCcjc2lnbi11cC1idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJCgnI3NpZ24tdXAtbW9kYWwnKS5tb2RhbCgnc2hvdycpXG4gICAgICAgIH0pXG5cbiAgICAgICAgJCgnI2xvZy1pbi1idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJCgnI2xvZy1pbi1tb2RhbCcpLm1vZGFsKCdzaG93JylcbiAgICAgICAgfSlcblxuICAgICAgICAkKCcjcGxheWVyLXRvZ2dsZScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkKCcjcGxheWVyLW1lbnUnKS50b2dnbGUoJ3NsaWRlJyk7XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICB9KVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMvbmF2aWdhdGlvbi9kaXJlY3RpdmUvbmF2aWdhdGlvbi5kaXJlY3RpdmUuanNcbiAqKiBtb2R1bGUgaWQgPSAyMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwicmVxdWlyZSgnLi9jb250cm9sbGVyL2luZGV4LmpzJyk7XG5yZXF1aXJlKCcuL2RpcmVjdGl2ZS9pbmRleC5qcycpO1xucmVxdWlyZSgnLi9zZXJ2aWNlL2luZGV4LmpzJyk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL25hdmlnYXRpb24vaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAyM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwicmVxdWlyZSgnLi9sb2dpbi5zZXJ2aWNlLmpzJyk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL25hdmlnYXRpb24vc2VydmljZS9pbmRleC5qc1xuICoqIG1vZHVsZSBpZCA9IDI0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbmd1bGFyLm1vZHVsZSgnbXVzaWNBcHAnKVxuICAuZmFjdG9yeSgndXNlckxvZ2luJywgWyckaHR0cCcsIGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxvZ2luOiBsb2dpblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvZ2luICh1c2VyTmFtZSwgcGFzc3dvcmQpIHtcblxuICAgICAgdmFyIHF1ZXJ5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICB1c2VyTmFtZTogdXNlck5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgfSlcblxuICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgIGRhdGE6IHF1ZXJ5LFxuICAgICAgICB1cmw6ICcvdXNlcnMvbG9naW4nLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJ1xuICAgICAgfSlcblxuICAgIH1cblxuICB9XSlcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL25hdmlnYXRpb24vc2VydmljZS9sb2dpbi5zZXJ2aWNlLmpzXG4gKiogbW9kdWxlIGlkID0gMjVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImFuZ3VsYXIubW9kdWxlKCdtdXNpY0FwcCcsIFtdKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL2pzL211c2ljLWFwcC5tb2R1bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIG1hcCA9IHtcblx0XCIuL2FuaW1hdGlvbnMvaW5kZXguanNcIjogMixcblx0XCIuL211c2ljL2NvbnRyb2xsZXIvaW5kZXguanNcIjogNCxcblx0XCIuL211c2ljL2RpcmVjdGl2ZS9pbmRleC5qc1wiOiA2LFxuXHRcIi4vbXVzaWMvaW5kZXguanNcIjogOCxcblx0XCIuL211c2ljL3NlcnZpY2UvaW5kZXguanNcIjogOSxcblx0XCIuL25hdmlnYXRpb24vY29udHJvbGxlci9pbmRleC5qc1wiOiAxOSxcblx0XCIuL25hdmlnYXRpb24vZGlyZWN0aXZlL2luZGV4LmpzXCI6IDIxLFxuXHRcIi4vbmF2aWdhdGlvbi9pbmRleC5qc1wiOiAyMyxcblx0XCIuL25hdmlnYXRpb24vc2VydmljZS9pbmRleC5qc1wiOiAyNFxufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyh3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSk7XG59O1xuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHRyZXR1cm4gbWFwW3JlcV0gfHwgKGZ1bmN0aW9uKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInLlwiKSB9KCkpO1xufTtcbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSAyNztcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvanMgXlxcLlxcLy4qXFwvaW5kZXhcXC5qcyRcbiAqKiBtb2R1bGUgaWQgPSAyN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==